!function(t){"use strict";function e(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function i(t){return e(t||new Date)}function s(t,e){if(!t)return null;var s=null;if("number"==typeof t)s=i(),s.setDate(s.getDate()+t);else if("string"==typeof t)try{s=o(e.dateFormat,t,e)}catch(a){s=i(),s.setDate(s.getDate()+ +t)}else s=t;return s}function a(t){return t=""+t,t.length<2?"0"+t:t}function n(e,i,s){var a,n,o,r=t.extend({},m,s),h=e.match(S),c="";for(a=0;a<h.length;a++)o=h[a],n=T[o]?T[o].call(i,r):o.match(/\[[\s\S]/)?o.replace(/^\[|\]$/g,""):o.replace(/\\/g,""),c+=n;return c}function o(e,i,s){function a(t,e){switch(t){case"d":case"dd":l.day=+e;break;case"m":case"mm":l.month=e-1;break;case"y":l.year=+e+(+e>68?1900:2e3);break;case"yy":l.year=+e;break;case"M":l.month=h(d.monthsShort,function(t){return t===e});break;case"MM":l.month=h(d.months,function(t){return t===e});break;case"@":l.epoch=+e}}var n,o,r,c,d=t.extend({},m,s),l={},p=e.match(S);for(n=0;n<p.length;n++)o=p[n],r=Y[o],r||(r=new RegExp(o,"i")),c=i.match(r),c&&(i=i.substr(c.index+c[0].length),a(o,c[0]));return l.epoch?new Date(l.epoch):new Date(l.year,l.month||0,l.day||1)}function r(t,e){for(var i,s,a,n,o,r,h=[],c=t.match(S);;){for(o=e,r=0,i=0;i<c.length;i++)s=c[i],a=Y[s],a||(a=new RegExp(s,"i")),n=o.match(a),n&&(r+=n.index+n[0].length,o=o.substr(n.index+n[0].length));if(e===o)break;h.push(e.substr(0,r)),e=e.substr(r)}return h}function h(t,e){for(var i=0;i<t.length;i++)if(e(t[i]))return i;return-1}function c(t){if("month"===this.view){9!==t.which&&27!==t.which||this.hide();var e=null;switch(t.which){case 37:e=-1;break;case 38:e=-7;break;case 39:e=1;break;case 40:e=7;break;case 13:this.options.keyboard&&(t.preventDefault(),this.activeDate||(this.activeDate=i(this.selectedDates.get(-1))),u.call(this,this.activeDate))}if(this.options.keyboard&&e){t.preventDefault(),this.activeDate||(this.activeDate=i(this.selectedDates.get(-1)));var a=s(this.options.minDate,this.options),n=s(this.options.maxDate,this.options),o=i(this.activeDate);o=o.setDate(o.getDate()+e),a&&a>o&&(e=0),n&&o>n&&(e=0),this.activeDate.setDate(this.activeDate.getDate()+e),this.currentDate=i(this.activeDate),this.render()}}}function d(e){e.preventDefault();var i=t(e.target).data("date"),s=o("yy-m-d",i,this.options);D.call(this,"changePeriod.datepicker",{date:s,period:this.view})||(this.currentDate=s,this.render())}function l(e){e.preventDefault();var i=t(e.target).data("view");D.call(this,"changeView.datepicker",{prevView:this.view,view:i})||(this.view=i,this.render())}function p(e){e.preventDefault();var i=t(e.target).data("date"),s=o("yy-m-d",i,this.options);u.call(this,s)}function u(t){if(this.view===k[this.options.selection]){D.call(this,"selectDate.datepicker",{date:t})||(this.selectedDates.push(t),this.activeDate=i(t),this.currentDate=i(t),this.val(this.selectedDates.get()),this.render());var e="range"===this.options.selectionMode;(!e||2!==this.selectedDates.get().length)&&e||D.call(this,"selectedDate.datepicker",{dates:this.selectedDates.get()})||this.hide()}else{var s;"decade"===this.view&&(s="year"),"year"===this.view&&(s="month"),D.call(this,"changeView.datepicker",{prevView:this.view,view:s})||(this.currentDate=t,this.view=s,this.render())}}function D(e,i){var s=t.Event(e,i);return this.$element.trigger(s),s.isDefaultPrevented()}function f(){var t=this.$container.outerWidth(),e=this.$container.outerHeight(),i=this.$element.offset(),s=this.$element.outerHeight(),a=this.$element.outerWidth(),n=i.top,o=i.left,r=this.options.align.split("-");"bottom"===r[0]&&(n+=s),"top"===r[0]&&(n-=e),"left"===r[0]&&(o-=t),"right"===r[0]&&(o+=a),"center"===r[1]&&(o+=a/2-t/2),"right"===r[1]&&(o+=a-t),"top"===r[1]&&(n-=e-s),"middle"===r[1]&&(n-=e/2-s/2),this.$container.css({left:o,top:n})}function g(){var t,e,a,o,r=i(),h=this.currentDate.getFullYear(),c=h-h%10,d=new Date(c-10,0,1),l=new Date(c+10,0,1);r.setMonth(0),r.setDate(1);var p=s(this.options.minDate,this.options),u=s(this.options.maxDate,this.options);p&&(p.setDate(1),p.setMonth(0)),u&&(u.setDate(1),u.setMonth(0));var D=p&&p.getFullYear()>new Date(c,0,1).getFullYear(),f=u&&u.getFullYear()<l.getFullYear(),g="";g+='<div class="datepicker-years">',g+='<div class="datepicker-header">',g+="<"+(D?"span":"a")+' class="prev-link"'+n(F,d)+">",g+=this.options.prevText,g+="</"+(D?"span":"a")+">",g+='<span class="datepicker-title">'+n("yy",new Date(c,0,1),this.options),g+=" - "+n("yy",new Date(c+9,0,1),this.options)+"</span>",g+="<"+(f?"span":"a")+' class="next-link"'+n(F,l)+">",g+=this.options.nextText,g+="</"+(f?"span":"a")+">",g+="</div>",g+="<table>",g+="<tbody>";var v=new Date(c,0,1),y=new Date(c-1,0,1),m=function(t,e){var i,s=e.getFullYear();for(i=0;i<t.length;i++)if(t[i].getFullYear()===s)return!0};for(t=0;4>t;t++){for(g+="<tr>",e=0;3>e;e++)a=[],o=!0,v>y&&(a.push("prev-month"),o=this.options.selectOtherMonths),y>=l&&(a.push("next-month"),o=this.options.selectOtherMonths),p&&p>y&&(o=!1),u&&y>u&&(o=!1),o||a.push("disabled"),r-y===0&&a.push("today"),m(this.selectedDates.dates,y)&&a.push("selected"),"range"===this.options.selectionMode&&this.selectedDates.inRange(y)&&a.push("range"),g+="<td"+(a.length>0?' class="'+a.join(" ")+'"':"")+">",g+=o?"<a "+n(F,y)+">":"<span>",g+=n("yy",y,this.options),g+=o?"</a>":"</span>",g+="</td>",y.setFullYear(y.getFullYear()+1);g+="</tr>"}return g+="</tbody>",g+="</table>",g+="</div>"}function v(){var t,e,a,o,r=this.currentDate.getFullYear(),h=this.currentDate.getMonth(),c=i(),d=new Date(r-1,0,1),l=new Date(r+1,0,1);c.setDate(1);var p=s(this.options.minDate,this.options),u=s(this.options.maxDate,this.options);p&&p.setDate(1),u&&u.setDate(1);var D=p&&p.getFullYear()>d.getFullYear(),f=u&&u.getFullYear()<l.getFullYear(),g="";g+='<div class="datepicker-months">',g+='<div class="datepicker-header">',g+="<"+(D?"span":"a")+' class="prev-link"'+n(F,d)+">",g+=this.options.prevText,g+="</"+(D?"span":"a")+">",g+='<a class="datepicker-title" data-view="decade">'+n("yy",this.currentDate,this.options)+"</a>",g+="<"+(f?"span":"a")+' class="next-link"'+n(F,l)+">",g+=this.options.nextText,g+="</"+(f?"span":"a")+">",g+="</div>",g+="<table>",g+="<tbody>";var v=new Date(r,h,1),y=function(t,e){var i,s,a=e.getFullYear(),n=e.getMonth();for(i=0;i<t.length;i++)if(s=t[i],s.getFullYear()===a&&s.getMonth()===n)return!0};for(t=0;4>t;t++){for(g+="<tr>",e=0;3>e;e++)v.setMonth(3*t+e),a=[],o=!0,p&&p>v&&(o=!1),u&&v>u&&(o=!1),o||a.push("disabled"),c-v===0&&a.push("today"),y(this.selectedDates.dates,v)&&a.push("selected"),"range"===this.options.selectionMode&&this.selectedDates.inRange(v)&&a.push("range"),g+="<td"+(a.length>0?' class="'+a.join(" ")+'"':"")+">",g+=o?"<a "+n(F,v)+">":"<span>",g+=n(this.options.monthFormat,v,this.options),g+=o?"</a>":"</span>",g+="</td>";g+="</tr>"}return g+="</tbody>",g+="</table>",g+="</div>"}function y(){var t,e,a,o,r=i(),h=this.currentDate.getFullYear(),c=this.currentDate.getMonth(),d=new Date(h,c,0),l=new Date(h,c+1,1),p=32-new Date(h,c,32).getDate(),u=32-new Date(h,c-1,32).getDate(),D=new Date(h,c,1).getDay()-this.options.firstDay;0>D&&(D+=7);var f=D+p,g=Math.ceil(f/7);"static"===this.options.rowsCount&&(g=6);var v=s(this.options.minDate,this.options),y=s(this.options.maxDate,this.options),m=v&&v>d,k=y&&l>y,w="";for(w+='<div class="datepicker-calendar">',w+='<div class="datepicker-header">',w+="<"+(m?"span":"a")+' class="prev-link"'+n(F,d)+">",w+=this.options.prevText,w+="</"+(m?"span":"a")+">",w+='<a class="datepicker-title" data-view="year">'+n("MM yy",this.currentDate,this.options)+"</a>",w+="<"+(k?"span":"a")+' class="next-link"'+n(F,l)+">",w+=this.options.nextText,w+="</"+(k?"span":"a")+">",w+="</div>",w+="<table>",w+="<thead>",w+="<tr>",t=0;7>t;t++)w+="<th>",w+="S"===this.options.dayHeaderFormat?this.options.daysShort[(t+this.options.firstDay)%7]:this.options.daysMin[(t+this.options.firstDay)%7],w+="</th>";w+="</tr>",w+="</thead>",w+="<tbody>";var M=new Date(h,c-1,u-D+1);for(t=0;g>t;t++){for(w+="<tr>",e=0;7>e;e++)a=[],o=!0,d>=M&&(a.push("prev-month"),o=this.options.selectOtherMonths),M>=l&&(a.push("next-month"),o=this.options.selectOtherMonths),v&&v>M&&(o=!1),y&&M>y&&(o=!1),o||a.push("disabled"),r-M===0&&a.push("today"),-1!==this.selectedDates.contains(M)&&a.push("selected"),"range"===this.options.selectionMode&&this.selectedDates.inRange(M)&&a.push("range"),this.activeDate&&this.activeDate-M===0&&a.push("active"),0===M.getDay()&&a.push("sunday"),6===M.getDay()&&a.push("saturday"),w+="<td"+(a.length>0?' class="'+a.join(" ")+'"':"")+">",w+=o?"<a "+n(F,M)+">":"<span>",w+=n(this.options.dayFormat,M,this.options),w+=o?"</a>":"</span>",w+="</td>",M.setDate(M.getDate()+1);w+="</tr>"}return w+="</tbody>",w+="</table>",w+="</div>"}var m={months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],container:'<div class="datepicker" tabindex="0"></div>',firstDay:0,defaultDate:null,altField:null,dateFormat:"mm/dd/yy",altFormat:null,align:"bottom-left",selectOtherMonths:!0,prevText:"&laquo;",nextText:"&raquo;",dayFormat:"d",dayHeaderFormat:"M",monthFormat:"M",rowsCount:"auto",minDate:null,maxDate:null,keyboard:!0,selection:"day",selectionMode:"single",separator:", ",inline:!1},k={day:"month",month:"year",year:"decade"},w='<div style="width: 0; height: 0; overflow: hidden; position: fixed; left: 0; top: 0;"><input type="text"></div>',F='\\data-\\date="yy-m-d"',M=/\d\d?/,b=/\d\d/,x=/\d{4}/,$=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Y={d:M,dd:b,D:$,DD:$,m:M,mm:b,M:$,MM:$,y:b,yy:x,"@":/\d+/},S=/(\[[^\[]*\])|(\\)?(dd|DD|mm|MM|yy|@|.)/g,T={d:function(){return this.getDate()},dd:function(){return a(this.getDate())},D:function(t){return t.daysShort[this.getDay()]},DD:function(t){return t.days[this.getDay()]},m:function(){return this.getMonth()+1},mm:function(){return a(this.getMonth()+1)},M:function(t){return t.monthsShort[this.getMonth()]},MM:function(t){return t.months[this.getMonth()]},y:function(){return a(this.getFullYear()%100)},yy:function(){return this.getFullYear()},"@":function(){return this.getTime()}},O=function(t){this.dates=[],this.isMulti="multi"===t,this.isRange="range"===t};O.prototype.get=function(t){return"undefined"==typeof t?this.dates:0>t?this.dates[this.dates.length+t]:this.dates[t]},O.prototype.push=function(t){if(t=i(t),this.isMulti){var e=this.contains(t);-1!==e?this.dates.splice(e,1):this.dates.push(t)}else this.isRange?(this.dates.length>1&&(this.dates.length=0),this.dates.push(t),this.dates.sort(function(t,e){return t-e})):this.dates.splice(0,1,t)},O.prototype.contains=function(t){t=i(t);for(var e=0;e<this.dates.length;e++)if(this.dates[e]-t===0)return e;return-1},O.prototype.inRange=function(t){return this.dates.length<2?!1:this.dates[0]<t&&this.dates[1]>t};var C=function(e,s){var a;this.$element=t(e),this.options=t.extend({},m,s),this.view=k[this.options.selection],this.isInput=this.$element.is("input"),this.selectedDates=new O(this.options.selectionMode);var n=this.options.defaultDate;if(n)for(t.isArray(n)||(n=[n]),a=0;a<n.length&&("string"==typeof n[a]?this.selectedDates.push(o(this.options.dateFormat,n[a],this.options)):this.selectedDates.push(n[a]),"single"!==this.options.selectionMode);a++);if(this.isInput&&""!==this.$element.val()){var h=r(this.options.dateFormat,this.$element.val());for(a=0;a<h.length&&(this.selectedDates.push(o(this.options.dateFormat,h[a],this.options)),"single"!==this.options.selectionMode);a++);}this.currentDate=i(this.selectedDates.get(0)),this.$container=t(this.options.container),this.$container.on("click",function(t){t.stopPropagation()}).on("click","a.prev-link, a.next-link",t.proxy(d,this)).on("click","a[data-view]",t.proxy(l,this)).on("click","table a",t.proxy(p,this)).on("keydown",t.proxy(c,this)),this.options.inline?(this.$container.addClass("datepicker-inline"),this.render(),this.$element.append(this.$container)):(this.$input=t(w),this.$input.find("input").on("keydown",t.proxy(c,this)),this.$container.addClass("datepicker-popup"),this.$element.on(this.isInput?"focus":"click",t.proxy(this.show,this)).on("keydown",t.proxy(c,this)))};C.prototype.show=function(e){if(!this.options.inline&&(e&&e.preventDefault(),!D.call(this,"show.datepicker"))){this.currentDate=i(this.selectedDates.get(0)),this.activeDate=null,this.view=k[this.options.selection],this.render(),t(document.body).append(this.$container),this.isInput||(t(document.body).append(this.$input),this.$input.find("input").focus()),this.$container.addClass("datepicker-align-"+this.options.align);var s=this;setTimeout(function(){s.$container.addClass("in")},25),f.call(this)}},C.prototype.hide=function(){this.options.inline||D.call(this,"hide.datepicker")||(this.$container.removeClass("in"),this.$container.detach(),this.isInput||this.$input.detach())},C.prototype.render=function(){"month"===this.view?this.$container.html(y.call(this)):"year"===this.view?this.$container.html(v.call(this)):this.$container.html(g.call(this))},C.prototype.changeView=function(t){if("decade"!==t&&"year"!==t&&"month"!==t)throw"Invalid view name";this.view=t,this.render()},C.prototype.val=function(e){if(!this.options.inline){var i,s,a=[];for(i=0;i<e.length;i++)a.push(n(this.options.dateFormat,e[i],this.options));if(s=a.join(this.options.separator),!D.call(this,"val.datepicker",{dates:e,formattedDates:s})){if(this.isInput?this.$element.val(s):this.$element.html(s),this.options.altField){var o=this.options.altFormat||this.options.dateFormat;for(a=[],i=0;i<e.length;i++)a.push(n(o,e[i],this.options));t(this.options.altField).val(a.join(this.options.separator))}D.call(this,"valSet.datepicker",{dates:e,formattedDates:s})}}},C.prototype.getDates=function(){return this.selectedDates.get()},C.prototype.setDates=function(i){var s,a;for(t.isArray(i)||(i=[i]),s=0;s<i.length&&(a=i[s],"string"==typeof a&&(a=o(this.options.dateFormat,a,this.options)),this.selectedDates.push(a),"single"!==this.options.selectionMode);s++);this.currentDate=e(this.selectedDates.get(0)),this.render(),this.val(this.selectedDates.get())},C.prototype.setOptions=function(e){this.options=t.extend({},this.options,e)},t.fn.datepicker=function(e,i){if("getDates"===e){var s=t(this[0]);s.datepicker();var a=s.data("datepicker.instance");return a[e](i)}return this.each(function(){var s=t(this),a=s.data("datepicker.instance");a||s.data("datepicker.instance",a=new C(this,"object"==typeof e&&e)).attr("data-datepicker-instance",""),"string"==typeof e&&a[e](i)})},t.datepicker={formatDate:n,parseDate:o,setDefaults:function(e){t.extend(m,e),t("[data-datepicker-instance]").datepicker("setOptions",e)}},t(document).on("click",function(e){t("[data-datepicker-instance]").each(function(){this===e.target||this.contains(e.target)||t(this).datepicker("hide")})}),t(document).on("click.datepicker","[data-datepicker]:not(input)",function(e){e.preventDefault(),t(this).datepicker("show")}).on("focus.datepicker","input[data-datepicker]",function(){t(this).datepicker()})}(window.jQuery);